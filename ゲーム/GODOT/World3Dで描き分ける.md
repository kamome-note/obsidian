World3Dで描き分ける　Godot
https://note.com/nwsnkn/n/n94216b0c9c8f

Godotエンジン、レイヤーを使わず複数のカメラを使う話。

---

## World3D

World3Dってリソースありますよね。内部にEnvironmentリソースと、CameraAttributeリソースを保持できます。Environmentは背景や環境光、CameraAttributeは露光やDoFに関するパラメータを持っていて、どちらも描画に関する設定です。
World3DはViewportノードにセットすることができます。world_3dプロパティです。これによって、そのViewportの描画先（派生クラスがWindowの場合は画面、SubViewportの場合はテクスチャ）の背景や環境光、露光が変わります。

![[Pasted image 20250211162136.png]]

World3Dを使うと、複数のカメラで描画する状況が楽に作れそうです。

例えばキャラクター選択画面で、各キャラの動くポートレートが並んでるような状況。Subviewportでテクスチャに描画して、それをTextureRectノードでUIに張り付けるということをすると思います。このとき、レンダーレイヤーで写しわけると、別々のマスク値を設定しなければなりません。他のUIでもレンダーレイヤーを使っているなら、値がかぶらないように処理する必要もあります。さらに、この方法では表示できるのは20キャラが限界です。ユーザーにはレイヤーが20種類しか解放されてないからです。

でも、SubviewportにWorld3Dを設定すれば、レイヤーの設定は不要です。他のUIとの兼ね合いを考えなくていいし、一度に表示できる数の限界も多分ありません。素直！

World3Dは文字通り、世界を表しているんだと思います。Subviewportに写すものが別々の場所にある場合は、レイヤーで分けるのではなく、World3Dで分けるのが、Godot流な気がします。

![[Pasted image 20250211162437.png]]
